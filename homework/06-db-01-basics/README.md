# Домашняя работа к занятию "6.1. Типы и структура СУБД"

## Введение

Перед выполнением задания вы можете ознакомиться с
[дополнительными материалами](https://github.com/netology-code/virt-homeworks/tree/master/additional/README.md).

## Задача 1

Архитектор ПО решил проконсультироваться у вас, какой тип БД
лучше выбрать для хранения определенных данных.

Он вам предоставил следующие типы сущностей, которые нужно будет хранить в БД:

- Электронные чеки в json виде
- Склады и автомобильные дороги для логистической компании
- Генеалогические деревья
- Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации
- Отношения клиент-покупка для интернет-магазина

Выберите подходящие типы СУБД для каждой сущности и объясните свой выбор.  

__ОТВЕТ:__

- *Электронные чеки в json виде* - Документная СУБД, совместно используют базовую семантику доступа и поиска хранилищ ключей и значений, документоориентированные базы хранят данные в структурированных форматах – JSON, BSON или XML. MongoDB, RethinkDB
- *Склады и автомобильные дороги для логистической компании* - Графовая (сетевая) СУБД, так как рёбра графа материализованы, то есть, являются хранимыми, обход графа не требует дополнительных вычислений, но для нахождения начальной вершины обхода требуется наличие индексов, применяются для задач, в которых данные имеют большое количество связей, Neo4j, OrientDB, AllegroGraph, Blazegraph, InfiniteGraph, FlockDB, Titan
- *Генеалогические деревья* - Иерархическая СУБД, служат для хранения иерархических структур данных, CouchDB, Couchbase, MongoDB, eXist, Berkeley DB XML
- *Кэш идентификаторов клиентов с ограниченным временем жизни для движка аутенфикации* - Memcached — программное обеспечение, реализующее сервис кэширования данных в оперативной памяти на основе хеш-таблицы.
- *Отношения клиент-покупка для интернет-магазина* - Ключ — значение. Модель «ключ — значение» является простейшим вариантом, использующим ключ для доступа к значению. Такие системы используются для хранения изображений, создания специализированных файловых систем, в качестве кэшей для объектов, а также в системах, спроектированных с прицелом на масштабируемость. Berkeley DB, MemcacheDB, Redis, Riak, Amazon DynamoDB.

## Задача 2

Вы создали распределенное высоконагруженное приложение и хотите классифицировать его согласно
CAP-теореме. Какой классификации по CAP-теореме соответствует ваша система, если
(каждый пункт - это отдельная реализация вашей системы и для каждого пункта надо привести классификацию):

- Данные записываются на все узлы с задержкой до часа (асинхронная запись)
- При сетевых сбоях, система может разделиться на 2 раздельных кластера
- Система может не прислать корректный ответ или сбросить соединение

А согласно PACELC-теореме, как бы вы классифицировали данные реализации?  

__ОТВЕТ:__  

- Данные записываются на все узлы с задержкой до часа (асинхронная запись) - т.к. данные записываются на *все узлы*, значит `P`, а дальше всё зависит от механизма синхронизации. Если данные записываются с задержкой значит в один момент времени согласованности не будет, а будет чтение несогласованных данных, т.е. доступность (*все узлы*) будет, значит `А` значит в РАС это будет `PА`, смотрим в PACELC, с `PА` всё уже понятно, данные записываются с задержкой значит при развале сети данные будут не согласованы, но наверное быстродоступны, значит `EL`.  Итого получилось `PА` (`PА/EL`. Хотя логику можно извратить и сказать, что раз данные записываются с задержкой, то они всё-таки будут согласованы, но некоторое время недоступны (во время синхронизации измененные данные не читаются на несинхронизированных узлах), то тогда получится `PC`
- При сетевых сбоях, система может разделиться на 2 раздельных кластера - т.к. при сбоях система не рушится, то `P`, кластеры *раздельные* значит согласованности нет, а доступность есть, значит `РA` из этого следует, что в PACELC будет `PA/EL`.  Итого `PA` (`PA/EL`)
- Система может не прислать корректный ответ или сбросить соединение - предположим, что система распределенная и она есть, значит `Р` а доступности и согласованности нет, значит просто `P`. что получится в PACELC даже не знаю, может быть `P`? Кому вообще понадобилась СУБД которая не обеспечивает самое главное, может быть она сломалась и её надо восстанавливать, а не классифицировать по PAC/PACELC?  

## Задача 3

Могут ли в одной системе сочетаться принципы BASE и ACID? Почему?  

__ОТВЕТ:__ В одной системе принципы BASE и ACID сочетаться не могут т.к. они взаимоисключающие (или к умным, или к красивым).  

- ACID это нормальная модель здоровой СУБД ориентированной на надежность, расшифровка говорит сама за себя - атомарность, согласованность, изоляция и долговечность.  
- BASE это пример того, как скорость ставится выше надежности и несогласованность данных в один момент времени это номальное состояние для таких систем. Согласованность в этом случае это вообще проблема разработчика, и есть только надежда, что когда-нибудь насткпит состояние, при котором данные будут согласованы.

## Задача 4

Вам дали задачу написать системное решение, основой которого бы послужили:

- фиксация некоторых значений с временем жизни
- реакция на истечение таймаута

Вы слышали о key-value хранилище, которое имеет механизм [Pub/Sub](https://habr.com/ru/post/278237/).
Что это за система? Какие минусы выбора данной системы?  

__ОТВЕТ:__ Будем использовать Redis, у него есть встроенная поддержка TTL (нам нужно время жизни и реакция на его истечение) и pub/sub (раз фиксируем значения, значит они от кого-то поступают, т.е. pub и кому-то нужны, т.е. sub)

---

### Как оформить ДЗ?

Выполненное домашнее задание пришлите ссылкой на .md-файл в вашем репозитории.

---
